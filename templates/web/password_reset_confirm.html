{% extends 'web/base.html' %}
{% load static %}

{% block title %}Proxynet - Redoc{% endblock %}

{% block content %}
<body>
    <div class="container mt-5">
        <h1>Password Reset Confirmation</h1>
        {% if message %}
          <div class="alert alert-success" role="alert">
            {{ message }}
          </div>
        {% endif %}
        <form method="post" onsubmit="return validateForm()">
            {% csrf_token %}
            <div class="mb-3">
                <label for="password">New Password</label>
                <input type="password" name="password" id="password" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="password_confirm">Confirm Password</label>
                <input type="password" name="password_confirm" id="password_confirm" class="form-control" required>
            </div>
            <p class="text-muted">Password must contain at least 8 characters, including a lowercase letter, an uppercase letter, a number, and a special character.</p>
            <button type="submit" class="btn btn-primary">Reset Password</button>
        </form>
    </div>

    <script>
        function validateForm() {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('password_confirm').value;

            // Check if passwords match
            if (password !== confirmPassword) {
                alert("Passwords do not match.");
                return false;
            }

            // Check password complexity requirements
            const complexityRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
            if (!complexityRegex.test(password)) {
                alert("Password must contain at least 8 characters, including a lowercase letter, an uppercase letter, a number, and a special character.");
                return false;
            }

            return true;
        }
    </script>
</body>
{% endblock %}
